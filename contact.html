<div class="resume-box">
    <h2 style="font-size: 2em;">Send a Message</h2>
    <form id="contactForm">
        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required placeholder="Your Name">
        </div>
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required placeholder="Your Email">
        </div>
        <div class="form-group">
            <label for="message">Message (or Bullet Points):</label>
            <textarea id="message" name="message" rows="8" required placeholder="- Type bullets here...
- And click 'Draft with AI'
- To turn them into a real email!"></textarea>
        </div>
        
        <div style="display: flex; gap: 10px; justify-content: center;">
            <button type="button" id="aiBtn" style="background-color: #8e44ad;">✨ Draft with AI</button>
            <button type="submit" id="submitBtn">Send Message</button>
        </div>
        
        <p id="statusMessage" style="display:none; margin-top:10px; font-weight:bold;"></p>
    </form>
</div>

<script>
    const BACKEND_URL = "https://your-app-name.onrender.com"; // UPDATE THIS!

    // 1. AI DRAFT BUTTON LOGIC
    document.getElementById('aiBtn').addEventListener('click', async function() {
        const messageBox = document.getElementById('message');
        const bullets = messageBox.value;
        const aiBtn = document.getElementById('aiBtn');

        if (!bullets.trim()) {
            alert("Please type some bullet points first!");
            return;
        }

        // UI Feedback
        aiBtn.disabled = true;
        aiBtn.innerText = "✨ Thinking...";
        
        try {
            const response = await fetch(`${BACKEND_URL}/api/draft-email`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ bullets: bullets })
            });
            const data = await response.json();
            
            if (data.draft) {
                // Replace the bullets with the generated email
                messageBox.value = data.draft;
            } else {
                alert("Error generating draft.");
            }
        } catch (error) {
            console.error(error);
            alert("Failed to reach AI.");
        } finally {
            aiBtn.disabled = false;
            aiBtn.innerText = "✨ Draft with AI";
        }
    });

    // 2. SEND BUTTON LOGIC (Same as before)
    document.getElementById('contactForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        // ... (Keep your existing send logic here) ...
        const statusMsg = document.getElementById('statusMessage');
        const submitBtn = document.getElementById('submitBtn');
        
        submitBtn.disabled = true;
        submitBtn.innerText = "Sending...";

        const formData = {
            name: document.getElementById('name').value,
            email: document.getElementById('email').value,
            message: document.getElementById('message').value
        };

        try {
            const response = await fetch(`${BACKEND_URL}/api/contact`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(formData)
            });
            
            if (response.ok) {
                statusMsg.style.display = 'block';
                statusMsg.innerText = "Thanks! Message received.";
                statusMsg.style.color = "green";
                document.getElementById('contactForm').reset();
            }
        } catch (error) {
            console.error(error);
        } finally {
            submitBtn.disabled = false;
            submitBtn.innerText = "Send Message";
        }
    });
</script>
